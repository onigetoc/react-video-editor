                    jaredLunde/masonic: 🧱 High-performance masonry layouts for React                                                   

[Skip to content](#start-of-content)  

Navigation Menu
---------------

Global navigation
=================

*   [Home](/dashboard)
*   [Issues](/issues)
*   [Pull requests](/pulls)
*   [Projects](/projects)
*   [Discussions](/discussions)
*   [Codespaces](https://github.com/codespaces)
*   [Copilot](/copilot)

*   [Explore](/explore)
*   [Marketplace](/marketplace)

Loading

© 2025 GitHub, Inc.

[About](https://github.com/about) [Blog](https://github.blog) [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service) [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement) [Security](https://github.com/security) [Status](https://www.githubstatus.com/)

### Uh oh!

There was an error while loading. Please reload this page.

[](https://github.com/)

[jaredLunde](/jaredLunde) jaredLunde /*   Show more breadcrumb items
    
    *   [jaredLunde](/jaredLunde)
    *   [masonic](/jaredLunde/masonic)
    
    /
[masonic](/jaredLunde/masonic) masonic /

Type / to search

Search code, repositories, users, issues, pull requests...
==========================================================

Search

Clear

0 suggestions.

[Search syntax tips](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax)

Give feedback

Provide feedback
================

We read every piece of feedback, and take your input very seriously.

 Include my email address so I can be contacted

Cancel Submit feedback

Saved searches
==============

Use saved searches to filter your results more quickly
------------------------------------------------------

Name  

Query 

To see all available qualifiers, see our [documentation](https://docs.github.com/search-github/github-code-search/understanding-github-code-search-syntax).

Cancel Create saved search

[](/copilot)Chat with Copilot     

Open Copilot…  

Create new...  

[](/issues)Your issues [](/pulls)Your pull requests

[](/notifications)You have unread notifications

  ![](https://avatars.githubusercontent.com/u/47570?v=4)

### Uh oh!

There was an error while loading. Please reload this page.

*   [Code](/jaredLunde/masonic)
*   [Issues 36](/jaredLunde/masonic/issues)
*   [Pull requests 0](/jaredLunde/masonic/pulls)
*   [Discussions](/jaredLunde/masonic/discussions)
*   [Actions](/jaredLunde/masonic/actions)
*   [Projects 0](/jaredLunde/masonic/projects)
*   [Security](/jaredLunde/masonic/security)
    
    [](/jaredLunde/masonic/security)
    
    [](/jaredLunde/masonic/security)
    
    [](/jaredLunde/masonic/security)
    
    [
    
    ### Uh oh!
    
    ](/jaredLunde/masonic/security)
    
    [There was an error while loading.](/jaredLunde/masonic/security) Please reload this page.
    
*   [Insights](/jaredLunde/masonic/pulse)

Additional navigation options

*   [Code](/jaredLunde/masonic)
*   [Issues](/jaredLunde/masonic/issues)
*   [Pull requests](/jaredLunde/masonic/pulls)
*   [Discussions](/jaredLunde/masonic/discussions)
*   [Actions](/jaredLunde/masonic/actions)
*   [Projects](/jaredLunde/masonic/projects)
*   [Security](/jaredLunde/masonic/security)
*   [Insights](/jaredLunde/masonic/pulse)

You signed in with another tab or window. Reload to refresh your session. You signed out in another tab or window. Reload to refresh your session. You switched accounts on another tab or window. Reload to refresh your session. Dismiss alert

![Owner avatar](https://avatars.githubusercontent.com/u/86995?s=48&v=4) **[masonic](/jaredLunde/masonic)** Public

*     
    
    Watch7
    
*   [Fork 55 Fork your own copy of jaredLunde/masonic](/jaredLunde/masonic/fork)
    
    Forks could not be loaded
    
    Loading
    
    ### Uh oh!
    
    There was an error while loading. Please reload this page.
    
*      Starred 1.2k
    
    #### Lists
    
    Loading
    
    ### Uh oh!
    
    There was an error while loading. Please reload this page.
    
      Star 1.2k
    
    #### Lists
    
    Loading
    
    ### Uh oh!
    
    There was an error while loading. Please reload this page.
    

 

Watch7

[](/jaredLunde/masonic/fork)Fork your own copy of jaredLunde/masonic

  Unstar this repository

  Star this repository

🧱 High-performance masonry layouts for React

[codesandbox.io/s/0oyxozv75v](https://codesandbox.io/s/0oyxozv75v "https://codesandbox.io/s/0oyxozv75v")

### License

[MIT license](/jaredLunde/masonic/blob/main/LICENSE)

### Code of conduct

[Code of conduct](/jaredLunde/masonic/blob/main/CODE_OF_CONDUCT.md)

[1.2k stars](/jaredLunde/masonic/stargazers) [55 forks](/jaredLunde/masonic/forks) [7 watching](/jaredLunde/masonic/watchers) [Branches](/jaredLunde/masonic/branches) [Tags](/jaredLunde/masonic/tags)

### Uh oh!

There was an error while loading. Please reload this page.

[Activity](/jaredLunde/masonic/activity)

Public repository

[Open in github.dev](https://github.dev/) [Open in a new github.dev tab](https://github.dev/) [Open in codespace](/codespaces/new/jaredLunde/masonic?resume=1)

jaredLunde/masonic
==================

 

 main

[**1** Branch](/jaredLunde/masonic/branches)[**25** Tags](/jaredLunde/masonic/tags)

[](/jaredLunde/masonic/branches)[](/jaredLunde/masonic/tags)

t

Go to file

Add file
--------

Add file

Add file
--------

Add file

Code

Open more actions menu

Folders and files
-----------------

Name

Name

Last commit message

Last commit date

Latest commit
-------------

[![semantic-release-bot](https://avatars.githubusercontent.com/u/32174276?v=4&size=40)](/semantic-release-bot)[semantic-release-bot](/jaredLunde/masonic/commits?author=semantic-release-bot)

[chore(release): 4.1.0](/jaredLunde/masonic/commit/308fce2904cfe79cc8d514aca9c4eafc73536348)

Open commit details

Apr 22, 2025

[308fce2](/jaredLunde/masonic/commit/308fce2904cfe79cc8d514aca9c4eafc73536348) · Apr 22, 2025

History
-------

[226 Commits](/jaredLunde/masonic/commits/main/)

Open commit details

[](/jaredLunde/masonic/commits/main/)

[.github](/jaredLunde/masonic/tree/main/.github ".github")

[.github](/jaredLunde/masonic/tree/main/.github ".github")

[feat: remove resize observer ponyfill (](/jaredLunde/masonic/commit/494a10f002a11ba81104c3877ee179f659f47c2b "feat: remove resize observer ponyfill (#159)
BREAKING CHANGE: removes the resize observer ponyfill.
Moving forward people will have to include their own global polyfill if they need one.")[#159](https://github.com/jaredLunde/masonic/pull/159)[)](/jaredLunde/masonic/commit/494a10f002a11ba81104c3877ee179f659f47c2b "feat: remove resize observer ponyfill (#159)
BREAKING CHANGE: removes the resize observer ponyfill.
Moving forward people will have to include their own global polyfill if they need one.")

Apr 26, 2024

[.husky](/jaredLunde/masonic/tree/main/.husky ".husky")

[.husky](/jaredLunde/masonic/tree/main/.husky ".husky")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

[docs](/jaredLunde/masonic/tree/main/docs "docs")

[docs](/jaredLunde/masonic/tree/main/docs "docs")

[feat: remove resize observer ponyfill (](/jaredLunde/masonic/commit/494a10f002a11ba81104c3877ee179f659f47c2b "feat: remove resize observer ponyfill (#159)
BREAKING CHANGE: removes the resize observer ponyfill.
Moving forward people will have to include their own global polyfill if they need one.")[#159](https://github.com/jaredLunde/masonic/pull/159)[)](/jaredLunde/masonic/commit/494a10f002a11ba81104c3877ee179f659f47c2b "feat: remove resize observer ponyfill (#159)
BREAKING CHANGE: removes the resize observer ponyfill.
Moving forward people will have to include their own global polyfill if they need one.")

Apr 26, 2024

[src](/jaredLunde/masonic/tree/main/src "src")

[src](/jaredLunde/masonic/tree/main/src "src")

[feat(use-positioner): add maxColumnWidth property (](/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc "feat(use-positioner): add maxColumnWidth property (#178)")[#178](https://github.com/jaredLunde/masonic/pull/178)[)](/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc "feat(use-positioner): add maxColumnWidth property (#178)")

Apr 22, 2025

[test](/jaredLunde/masonic/tree/main/test "test")

[test](/jaredLunde/masonic/tree/main/test "test")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

[types](/jaredLunde/masonic/tree/main/types "types")

[types](/jaredLunde/masonic/tree/main/types "types")

[chore(release): 4.1.0](/jaredLunde/masonic/commit/308fce2904cfe79cc8d514aca9c4eafc73536348 "chore(release): 4.1.0
# [4.1.0](https://github.com/jaredLunde/masonic/compare/v4.0.1...v4.1.0) (2025-04-22)
### Features
* **use-positioner:** add maxColumnWidth property ([#178](https://github.com/jaredLunde/masonic/issues/178)) ([850e21a](https://github.com/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc))")

Apr 22, 2025

[.gitignore](/jaredLunde/masonic/blob/main/.gitignore ".gitignore")

[.gitignore](/jaredLunde/masonic/blob/main/.gitignore ".gitignore")

[Updates build environment and deps](/jaredLunde/masonic/commit/18d549961ffb68ec5d9a74b2369b21ce3404b9ea "Updates build environment and deps")

Jun 5, 2020

[CHANGELOG.md](/jaredLunde/masonic/blob/main/CHANGELOG.md "CHANGELOG.md")

[CHANGELOG.md](/jaredLunde/masonic/blob/main/CHANGELOG.md "CHANGELOG.md")

[chore(release): 4.1.0](/jaredLunde/masonic/commit/308fce2904cfe79cc8d514aca9c4eafc73536348 "chore(release): 4.1.0
# [4.1.0](https://github.com/jaredLunde/masonic/compare/v4.0.1...v4.1.0) (2025-04-22)
### Features
* **use-positioner:** add maxColumnWidth property ([#178](https://github.com/jaredLunde/masonic/issues/178)) ([850e21a](https://github.com/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc))")

Apr 22, 2025

[CODE\_OF\_CONDUCT.md](/jaredLunde/masonic/blob/main/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md")

[CODE\_OF\_CONDUCT.md](/jaredLunde/masonic/blob/main/CODE_OF_CONDUCT.md "CODE_OF_CONDUCT.md")

[Type LoadMoreItemsCallback\['stopIndex'\] could be undefined](/jaredLunde/masonic/commit/1a0c0d5f942d8d7bace8fa47f5aed0345e13a276 "Type LoadMoreItemsCallback['stopIndex'] could be undefined")

Apr 29, 2020

[CONTRIBUTING.md](/jaredLunde/masonic/blob/main/CONTRIBUTING.md "CONTRIBUTING.md")

[CONTRIBUTING.md](/jaredLunde/masonic/blob/main/CONTRIBUTING.md "CONTRIBUTING.md")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

[LICENSE](/jaredLunde/masonic/blob/main/LICENSE "LICENSE")

[LICENSE](/jaredLunde/masonic/blob/main/LICENSE "LICENSE")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

[README.md](/jaredLunde/masonic/blob/main/README.md "README.md")

[README.md](/jaredLunde/masonic/blob/main/README.md "README.md")

[feat(use-positioner): add maxColumnWidth property (](/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc "feat(use-positioner): add maxColumnWidth property (#178)")[#178](https://github.com/jaredLunde/masonic/pull/178)[)](/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc "feat(use-positioner): add maxColumnWidth property (#178)")

Apr 22, 2025

[babel.config.js](/jaredLunde/masonic/blob/main/babel.config.js "babel.config.js")

[babel.config.js](/jaredLunde/masonic/blob/main/babel.config.js "babel.config.js")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

[package.json](/jaredLunde/masonic/blob/main/package.json "package.json")

[package.json](/jaredLunde/masonic/blob/main/package.json "package.json")

[chore(release): 4.1.0](/jaredLunde/masonic/commit/308fce2904cfe79cc8d514aca9c4eafc73536348 "chore(release): 4.1.0
# [4.1.0](https://github.com/jaredLunde/masonic/compare/v4.0.1...v4.1.0) (2025-04-22)
### Features
* **use-positioner:** add maxColumnWidth property ([#178](https://github.com/jaredLunde/masonic/issues/178)) ([850e21a](https://github.com/jaredLunde/masonic/commit/850e21a857646241fed5e9c5fa7fcca0d11d75bc))")

Apr 22, 2025

[pnpm-lock.yaml](/jaredLunde/masonic/blob/main/pnpm-lock.yaml "pnpm-lock.yaml")

[pnpm-lock.yaml](/jaredLunde/masonic/blob/main/pnpm-lock.yaml "pnpm-lock.yaml")

[fix: ts/js is a joke of an ecosystem (](/jaredLunde/masonic/commit/900bb10fa0ebc8e4be0e02393a3949c70511016f "fix: ts/js is a joke of an ecosystem (#160)")[#160](https://github.com/jaredLunde/masonic/pull/160)[)](/jaredLunde/masonic/commit/900bb10fa0ebc8e4be0e02393a3949c70511016f "fix: ts/js is a joke of an ecosystem (#160)")

Apr 26, 2024

[tsconfig.json](/jaredLunde/masonic/blob/main/tsconfig.json "tsconfig.json")

[tsconfig.json](/jaredLunde/masonic/blob/main/tsconfig.json "tsconfig.json")

[fix(use-scroller): unsubscribe from updates when hook has unmounted (](/jaredLunde/masonic/commit/2117625fb14b27b5f33a3a8121cbb83a62de5b5c "fix(use-scroller): unsubscribe from updates when hook has unmounted (#97)
* fix(use-scroller): unsubscribe from updates when hook has unmounted
* chore: add master branch github action branches")[#97](https://github.com/jaredLunde/masonic/pull/97)

Oct 23, 2021

View all files

Repository files navigation
---------------------------

*   [README](#)
*   [Code of conduct](#)
*   [MIT license](#)

Edit file

* * *

🧱 masonic
==========

[](#-----masonic--)

[![Supported by FlexStack](https://camo.githubusercontent.com/4e49eb33c5890126572f33c97e9b11fd33be569b80a03c822584fd9c081b9160/68747470733a2f2f666c6578737461636b2e636f6d2f696d616765732f737570706f727465642d62792d666c6578737461636b2e7376673f7631)](https://flexstack.com)

* * *

 [![Bundlephobia](https://camo.githubusercontent.com/c0822b3e5a094c921badc34b8a9918b551e82d573fd3c812adddb2f6a3d95e92/68747470733a2f2f696d672e736869656c64732e696f2f62756e646c6570686f6269612f6d696e7a69702f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265)](https://bundlephobia.com/result?p=masonic)[![Types](https://camo.githubusercontent.com/6fe2bab862c0e728b308513429f54a2ed4c24fa5d217e743bdd9a73a56c8dea8/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f74797065732f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265) ](https://www.npmjs.com/package/masonic)[![Code coverage](https://camo.githubusercontent.com/c2f93483415e54d58cde9956f9c5804acfdb2f4bd9286b4b34457d83ba891060/68747470733a2f2f696d672e736869656c64732e696f2f636f6465636f762f632f67682f6a617265644c756e64652f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265) ](https://codecov.io/gh/jaredLunde/masonic)[![Build status](https://camo.githubusercontent.com/41c1fb3fb2ab45f87080f2596cef5a232972c866e71b9560a620b0448cce8399/68747470733a2f2f696d672e736869656c64732e696f2f7472617669732f636f6d2f6a617265644c756e64652f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265) ](https://travis-ci.com/jaredLunde/masonic)[![NPM Version](https://camo.githubusercontent.com/b54a71e222d008709e048da18cbed1ad985aa2325236bdb7eec6240edea0390f/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f762f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265) ](https://www.npmjs.com/package/masonic)[![MIT License](https://camo.githubusercontent.com/f4b2dbbf59ed6b1193dd4ecc7b60e1557898338612ee82fc6ef7fc7a9e058cac/68747470733a2f2f696d672e736869656c64732e696f2f6e706d2f6c2f6d61736f6e69633f7374796c653d666f722d7468652d6261646765266c6162656c436f6c6f723d323432393265)](https://jaredlunde.mit-license.org/)

npm i masonic

A performant and versatile virtualized masonry grid for React based on Brian Vaughn's [react-virtualized](https://github.com/bvaughn/react-virtualized) and further inspired by [react-window](https://github.com/bvaughn/react-window).

Using Masonic, you're not just getting a component. You're getting the implementation details, as well, meaning advanced usage requiring little code is possible.

Features
--------

[](#features)

*    **Easy to use** It takes two minutes to start creating your own masonry grid with this component. [For real, check out the demo on **CodeSandbox**](https://codesandbox.io/s/0oyxozv75v).
*    **Blazing™ fast** This component can seamlessly render tens of thousands of grid cells without lag via its virtualization algorithm and underlying [data structures](https://www.scaler.com/topics/data-structures/what-is-data-structure/). For example, it uses a [red black interval tree](https://www.geeksforgeeks.org/interval-tree/) to determine which cells to render, based upon the scroll position and size of the window the grid is rendered in. Interval trees have `O(log n + m)` search performance 😱.
*    **TypeScript** Intellisense and type safety mean fewer bugs in your implementation.
*    **Versatility** All of [`<Masonry>`](#masonry)'s implementation details (hooks, utilities) are exported, so you're not locked into to the default implementation. As you advance, it will be useful to have access to those internals. It's also possible to kick the virtualization out of the equation by providing an `Infinity` value to the `overscanBy` prop, though this would be a terrible idea for large lists.
*    **Autosizing** The default [`<Masonry>`](#masonry) component will automatically resize itself and its items if the content of the grid cells changes or resizes. For example, when an image lazily loads this component will automatically do the work of recalculating the size of that grid cell. That said, you should try to premeasure things (including images) as often as possible in order to achieve the best user experience.

Quick Start
-----------

[](#quick-start)

[Check out the demo on **CodeSandbox**](https://codesandbox.io/s/0oyxozv75v)

import \* as React from "react";
import { Masonry } from "masonic";

let i \= 0;
const items \= Array.from(Array(5000), () \=> ({ id: i++ }));

const EasyMasonryComponent \= (props) \=> (
  <Masonry items\={items} render\={MasonryCard} />
);

const MasonryCard \= ({ index, data: { id }, width }) \=> (
  <div\>
    <div\>Index: {index}</div\>
    <pre\>ID: {id}</pre\>
    <div\>Column width: {width}</div\>
  </div\>
);

Documentation
-------------

[](#documentation)

### Components

[](#components)

Component

Description

[`<Masonry>`](#masonry)

A "batteries included" masonry grid which includes all of the implementation details below. This component is the easiest way to get off and running in your app, before switching to more advanced implementations, if necessary. It will change its column count to fit its container's width and will decide how many rows to render based upon the height of the browser `window`.

[`<MasonryScroller>`](#masonryscroller)

A heavily-optimized component that updates [`useMasonry()`](#usemasonryoptions) when the scroll position of the browser `window` changes. This bare-metal component is used by [`<Masonry>`](#masonry) above.

[`<List>`](#list)

This is just a single-column [`<Masonry>`](#masonry) component with no `columnGutter` prop, only `rowGutter`.

### Hooks

[](#hooks)

Hook

Description

[`useMasonry()`](#usemasonryoptions)

This hook handles the render phases of the masonry layout and returns the grid as a React element.

[`usePositioner()`](#usepositioneroptions-deps)

This hook creates the grid cell positioner and cache required by [`useMasonry()`](#usemasonryoptions). This is the meat of the grid's layout algorithm, determining which cells to render at a given scroll position, as well as where to place new items in the grid.

[`useResizeObserver()`](#useresizeobserverpositioner)

Creates a resize observer that forces updates to the grid when mutations are made to the grid cells affecting their size.

[`useContainerPosition()`](#usecontainerpositionelementref-deps)

A hook for measuring the width of the grid container, as well as its distance from the top of the document. These values are necessary to correctly calculate the number/width of columns to render, as well as the number of rows to render.

[`useScroller()`](#usescrolleroffset-fps)

A hook for tracking whether the `window` is currently being scrolled and it's scroll position on the y-axis. These values are used for determining which grid cells to render and when to add styles to the grid container that maximize scroll performance.

[`useScrollToIndex()`](#usescrolltoindexpositioner-options)

A hook that creates a callback for scrolling to a specific index in the "items" array.

[`useInfiniteLoader()`](#useinfiniteloaderloadmoreitems-options)

A utility hook for seamlessly adding infinite scroll behavior to the [`useMasonry()`](#usemasonryoptions) hook. This hook invokes a callback each time the last rendered index surpasses the total number of items in your items array or the number defined in the `totalItems` option of this hook.

### Utilities

[](#utilities)

Utility

Description

[`createPositioner()`](#createpositionercolumncount-columnwidth-columngutter-rowgutter)

Creates a cell positioner for the [`useMasonry()`](#usemasonryoptions) hook. The [`usePositioner()`](#usepositioneroptions-deps) hook uses this utility under the hood.

[`createResizeObserver()`](#createresizeobserverpositioner-updater)

Creates a resize observer that fires an `updater` callback whenever the height of one or many cells change. The [`useResizeObserver()`](#useresizeobserverpositioner) hook is using this under the hood.

### Recipes

[](#recipes)

*   [Add infinite scrolling behavior to your Masonry component.](https://codesandbox.io/s/useinfiniteloader-example-vn30p?file=/src/index.js)
*   [Cells don't resize once they're measured? Build a Masonry grid without the resize observer.](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)
*   [Reset `<Masonry>` layout when switching between routes within the same component.](https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js)
    *   [Do the same with an advanced custom implementation using the `usePositioner()` hook.](https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js)
*   [Render a Masonry component relative to a scrollable HTML element rather than the browser `window`.](https://codesandbox.io/s/masonic-inside-of-a-scrollable-div-example-k9l6c?file=/src/index.js)
*   [Add an `isScrolling` prop to cells](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)

* * *

### <Masonry>

[](#masonry)

An autosizing masonry grid that only renders items currently visible in the browser `window`. This component will change its column count to fit its container's width and will decide how many rows to render based upon the height of the browser `window`. To facilitate this, it uses [`useMasonry()`](#usemasonryoptions), [`usePositioner()`](#usepositioneroptions-deps), [`useResizeObserver()`](#useresizeobserverpositioner), [`useContainerPosition()`](#usecontainerpositionelementref-deps), and [`useScroller()`](#usescrolleroffset-fps) under the hood.

This is the "batteries included" option. It's the easiest way to get off and running with your app and a great stepping stone to more advanced implementations, should you need them.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/0oyxozv75v)

import \* as React from "react";
import { Masonry } from "masonic";

let i \= 0;
const items \= Array.from(Array(5000), () \=> ({ id: i++ }));

const EasyMasonryComponent \= (props) \=> (
  <Masonry items\={items} render\={MasonryCard} />
);

const MasonryCard \= ({ index, data: { id }, width }) \=> (
  <div\>
    <div\>Index: {index}</div\>
    <pre\>ID: {id}</pre\>
    <div\>Column width: {width}</div\>
  </div\>
);

#### Props

[](#props)

**Required props**

Prop

Type

Required?

Description

items

`any[]`

Yes

An array containing the data used by the grid items.

render

[`React.ComponentType<RenderComponentProps>`](#rendercomponentprops)

Yes

This component is rendered for each item of your `items` prop array. It should accept three props: `index`, `width`, and `data`. See [`RenderComponentProps`](#rendercomponentprops) for more detail on those props.

**Column props**

Props for tuning the column width, count, and gutter of your component.

Prop

Type

Default

Required?

Description

columnWidth

`number`

`240`

No

This is the minimum column width. `Masonic` will automatically size your columns to fill its container based on your provided `columnWidth` and `columnGutter` values. It will never render anything smaller than this defined width unless its container is smaller than its value.

columnGutter

`number`

`0`

No

This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this also sets the vertical space between cells within a column in pixels.

rowGutter

`number`

Same as `columnGutter`

No

This sets the vertical space between cells within a column in pixels.

columnCount

`number`

No

By default, `Masonic` derives the column count from the `columnWidth` prop. However, in some situations it is nice to be able to override that behavior e.g. when creating a [`<List>`](#list).

maxColumnCount

`number`

No

Limits the number of columns used by `Masonic`. Useful for implementing responsive layouts.

maxColumnWidth

`number`

No

Limits the calculated width of columns rendered by `Masonic`.

**Grid container props**

These props customize how the grid container element is rendered.

Prop

Type

Default

Required?

Description

as

`keyof JSX.IntrinsicElements | React.ComponentType<any>`

`"div"`

No

This is the type of element the grid container will be rendered as.

id

`string`

No

Gives the grid container an `id`.

className

`string`

No

Gives the grid container a `className`.

style

`React.CSSProperties`

No

Adds extra `style` attributes to the container in addition to those created by the [`useMasonry()`](#usemasonryoptions) hook.

role

`"grid" | "list"`

`"grid"`

No

Optionally swap out the accessibility `role` prop of the container and its items.

tabIndex

`number`

`0`

No

Change the `tabIndex` of the grid container.

**Grid item props**

Props that customize how individual grid item containers are rendered.

Prop

Type

Default

Required?

Description

itemAs

`keyof JSX.IntrinsicElements | React.ComponentType<any>`

`"div"`

No

This is the type of element the grid items will be rendered as.

itemStyle

`React.CSSProperties`

No

Adds extra `style` attributes to the grid items in addition to those created by the [`useMasonry()`](#usemasonryoptions) hook.

itemHeightEstimate

`number`

`300`

No

This value is used for estimating the initial height of the masonry grid. It is important for the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's wise to set this value with some level accuracy, though it doesn't need to be perfect.

itemKey

`(data: any, index: number) => string | number`

`(data, index) => index`

No

The value returned here must be unique to the item. By default, the key is the item's index. This is ok if your collection of items is never modified. Setting this property ensures that the component in `render` is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database ID here if there is one, e.g. `data => data.id`

**Callbacks**

Prop

Type

Default

Required?

Description

onRender

`(startIndex: number, stopIndex: number, items: any[]) => void`

No

This callback is invoked any time the items currently being rendered by the grid change. See [onRender() arguments](#onrender-arguments).

**Other props**

Prop

Type

Default

Required?

Description

overscanBy

`number`

`2`

No

This number is used for determining the number of grid cells outside of the visible window to render. The default value is `2` which means "render 2 windows worth (2 \* `height`) of content before and after the items in the visible window". A value of `3` would be 3 windows worth of grid cells, so it's a linear relationship. Overscanning is important for preventing tearing when scrolling through items in the grid, but setting too high of a value may create too much work for React to handle, so it's best that you tune this value accordingly.

scrollToIndex

`number` | `{index: number, align: "top" | "center" | "bottom"}`

No

Scrolls to a given index within the grid. The grid will re-scroll any time the index changes.

#### `onRender()` arguments

[](#onrender-arguments)

Argument

Type

Description

startIndex

`number`

The index of the first item currently being rendered in the window

stopIndex

`number`

The index of the last item currently being rendered in the window

items

`any[]`

The array of items you provided to the `items` prop

### RenderComponentProps

[](#rendercomponentprops)

Prop

Type

Description

index

`number`

The index of the cell in the `items` prop array.

width

`number`

The rendered width of the cell's column.

data

`any`

The data at `items[index]` of your `items` prop array..

* * *

### <MasonryScroller>

[](#masonryscroller)

A heavily-optimized component that updates [`useMasonry()`](#usemasonryoptions) when the scroll position of the browser `window` changes. This bare-metal component is used by [`<Masonry>`](#masonry) above.

When would you use this? If you're building an advanced masonry grid implementation, but you don't want to deal with figuring out how to optimize the exchange between scroll position changes in the browser `window` and the [`useMasonry() hook`](#usemasonryoptions).

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/masonryscroller-example-b7xvn?file=/src/index.js)

import \* as React from "react";
import { MasonryScroller, usePositioner, useContainerPosition } from "masonic";
import { useWindowSize } from "@react-hook/window-size";

const MyMasonry \= (props) \=> {
  const containerRef \= React.useRef(null);
  const \[windowWidth, windowHeight\] \= useWindowSize();
  const { offset, width } \= useContainerPosition(containerRef, \[
    windowWidth,
    windowHeight,
  \]);
  const positioner \= usePositioner({ width, columnWidth: 320 });

  return (
    <MasonryScroller
      positioner\={positioner}
      // The distance in px between the top of the document and the top of the
      // masonry grid container
      offset\={offset}
      // The height of the virtualization window
      height\={windowHeight}
      // Forwards the ref to the masonry container element
      containerRef\={containerRef}
      {...props}
    />
  );
};

#### Props

[](#props-1)

In addition to these props, this component accepts all of the props outlined in [`<Masonry>`](#masonry) with exception to `columnGutter`, `rowGutter`, `columnWidth`, `columnCount`, `maxColumntCount`, `ssrWidth`, and `ssrHeight`.

Prop

Type

Default

Required?

Description

offset

`number`

`0`

No

The vertical space in pixels between the top of the grid container and the top of the browser `document.documentElement`.

height

`number`

Yes

This is the height of the window. If you're rendering the grid relative to the browser `window`, the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight` here.

positioner

[`Positioner`](#positioner)

Yes

A grid cell positioner and cache created by the [`usePositioner()`](#usepositioneroptions-deps) hook or [`createPositioner()`](#createpositionercolumncount-columnwidth-columngutter-rowgutter) utility.

containerRef

`React.MutableRefObject<HTMLElement | null>`

No

Forwards a React ref to the grid container.

resizeObserver

`ResizeObserver`

No

A resize observer that tracks mutations to the grid cells and forces the Masonry grid to recalculate its layout if any cells affect column heights change. Check out the [`useResizeObserver()`](#useresizeobserverpositioner) hook and [`createResizeObserver()`](#createresizeobserverpositioner-updater) utility.

* * *

### <List>

[](#list)

This is a single-column [`<Masonry>`](#masonry) component. That is, it uses the [`useMasonry()`](#usemasonryoptions) hook and other utilities to create a virtualized list.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/list-example-3g0tc?file=/src/index.js)

import \* as React from "react";
import { List } from "masonic";

let i \= 0;
const items \= Array.from(Array(5000), () \=> ({ id: i++ }));

const EasyListComponent \= (props) \=> (
  <List items\={items} rowGutter\={32} render\={ListCard} />
);

const ListCard \= ({ index, data: { id }, width }) \=> (
  <div\>
    <div\>Index: {index}</div\>
    <pre\>ID: {id}</pre\>
    <div\>Column width: {width}</div\>
  </div\>
);

#### Props

[](#props-2)

In addition to these props, this component accepts all of the props outlined in [`<Masonry>`](#masonry) with exception to `columnGutter`, `columnWidth`, `columnCount`, and `maxColumnCount`.

Prop

Type

Default

Required?

Description

rowGutter

`number`

`0`

No

The amount of vertical space in pixels to add between list item cards.

* * *

### useMasonry(options)

[](#usemasonryoptions)

This hook handles the render phases of the masonry layout and returns the grid as a React element.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)

import \* as React from "react";
import { useWindowSize } from "@react-hook/window-size";
import {
  useMasonry,
  usePositioner,
  useContainerPosition,
  useScroller,
} from "masonic";

const MyMasonry \= (props) \=> {
  const containerRef \= React.useRef(null);
  const \[windowWidth, height\] \= useWindowSize();
  const { offset, width } \= useContainerPosition(containerRef, \[
    windowWidth,
    height,
  \]);
  const { scrollTop, isScrolling } \= useScroller(offset);
  const positioner \= usePositioner({ width });

  return useMasonry({
    positioner,
    scrollTop,
    isScrolling,
    height,
    containerRef,
    ...props,
  });
};

#### Arguments

[](#arguments)

Argument

Type

Description

options

[`UseMasonryOptions`](#usemasonryoptions-1)

The distance in pixels between the top of your masonry container and the top of the document

#### UseMasonryOptions

[](#usemasonryoptions-1)

**Required options**

Prop

Type

Required?

Description

items

`any[]`

Yes

An array containing the data used by the grid items.

positioner

[`Positioner`](#positioner)

Yes

A grid cell positioner and cache created by the [`usePositioner()`](#usepositioneroptions-deps) hook or [`createPositioner()`](#createpositionercolumncount-columnwidth-columngutter-rowgutter) utility.

height

`number`

Yes

This is the height of the window. If you're rendering the grid relative to the browser `window`, the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight` here.

scrollTop

`number`

Yes

The current scroll progress in pixel of the window the grid is rendered in. If you're rendering the grid relative to the browser `window`, you'll want the most current `window.scrollY` here. If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop` value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're rendering the grid relative to the browser `window`.

render

[`React.ComponentType<RenderComponentProps>`](#rendercomponentprops)

Yes

This component is rendered for each item of your `items` prop array. It should accept three props: `index`, `width`, and `data`. See [`RenderComponentProps`](#rendercomponentprops).

**Grid container options**

Prop

Type

Default

Required?

Description

as

`keyof JSX.IntrinsicElements | React.ComponentType<any>`

`"div"`

No

This is the type of element the grid container will be rendered as.

id

`string`

No

Optionally gives the grid container an `id` prop.

className

`string`

No

Optionally gives the grid container a `className` prop.

style

`React.CSSProperties`

No

Adds extra `style` attributes to the container in addition to those created by the [`useMasonry()`](#usemasonryoptions) hook.

role

`"grid" | "list"`

`"grid"`

No

Optionally swap out the accessibility `role` prop of the container and its items.

tabIndex

`number`

`0`

No

Change the `tabIndex` of the grid container.

containerRef

`React.MutableRefObject<HTMLElement | null>`

No

Forwards a React ref to the grid container.

**Grid item options**

Prop

Type

Default

Required?

Description

itemAs

`keyof JSX.IntrinsicElements | React.ComponentType<any>`

`"div"`

No

This is the type of element the grid items will be rendered as.

itemStyle

`React.CSSProperties`

No

Adds extra `style` attributes to the grid items in addition to those created by the [`useMasonry()`](#usemasonryoptions) hook.

itemHeightEstimate

`number`

`300`

No

This value is used for estimating the initial height of the masonry grid. It is important for the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's wise to set this value with some level accuracy, though it doesn't need to be perfect.

itemKey

`(data: any, index: number) => string | number`

`(data, index) => index`

No

The value returned here must be unique to the item. By default, the key is the item's index. This is ok if your collection of items is never modified. Setting this property ensures that the component in `render` is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database ID here if there is one, e.g. `data => data.id`

**Callbacks**

Prop

Type

Default

Required?

Description

onRender

`(startIndex: number, stopIndex: number | undefined, items: any[]) => void`

No

This callback is invoked any time the items currently being rendered by the grid change.

**Other options**

Prop

Type

Default

Required?

Description

overscanBy

`number`

`2`

No

This number is used for determining the number of grid cells outside of the visible window to render. The default value is `2` which means "render 2 windows worth (2 \* `height`) of content before and after the items in the visible window". A value of `3` would be 3 windows worth of grid cells, so it's a linear relationship. Overscanning is important for preventing tearing when scrolling through items in the grid, but setting too high of a value may create too much work for React to handle, so it's best that you tune this value accordingly.

resizeObserver

`ResizeObserver`

No

A resize observer that tracks mutations to the grid cells and forces the Masonry grid to recalculate its layout if any cells affect column heights change. Check out the [`useResizeObserver()`](#useresizeobserverpositioner) hook and [`createResizeObserver()`](#createresizeobserverpositioner-updater) utility.

* * *

### usePositioner(options, deps?)

[](#usepositioneroptions-deps)

This hook creates the grid cell positioner and cache required by [`useMasonry()`](#usemasonryoptions). This is the meat of the grid's layout algorithm, determining which cells to render at a given scroll position, as well as where to place new items in the grid.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)

import \* as React from "react";
import { usePositioner, useContainerPosition, MasonryScroller } from "masonic";

const MyMasonry \= ({ columnWidth \= 300, columnGutter \= 16, ...props }) \=> {
  const { width, offset } \= useContainerPosition();
  const positioner \= usePositioner({ width, columnWidth, columnGutter });
  return <MasonryScroller positioner\={positioner} offset\={offset} {...props} />;
};

#### Arguments

[](#arguments-1)

Argument

Type

Default

Required?

Description

options

[`UsePositionerOptions`](#usepositioneroptions-depsoptions)

Yes

Properties that determine the number of columns in the grid, as well as their widths.

deps

`React.DependenciesList`

`[]`

No

This hook will create a new positioner, clearing all existing cached positions, whenever the dependencies in this list change.

#### UsePositionerOptions

[](#usepositioneroptions)

Argument

Type

Default

Required?

Description

width

`number`

Yes

The width of the container you're rendering the grid within, e.g. the container element's `element.offsetWidth`. That said, you can provide any width here.

columnWidth

`number`

`200`

No

The minimum column width. The [`usePositioner()`](#usepositioneroptions-deps) hook will automatically size the columns to fill their container based upon the `columnWidth` and `columnGutter` values. It will never render anything smaller than this width unless its container itself is smaller than its value. This property has no effect if you're providing a `columnCount`.

columnGutter

`number`

`0`

No

This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this also sets the vertical space between cells within a column in pixels.

rowGutter

`number`

Same as `columnGutter`

No

This sets the vertical space between cells within a column in pixels.

columnCount

`number`

No

By default, [`usePositioner()`](#usepositioneroptions-deps) derives the column count from the `columnWidth`, `columnGutter`, and `width` props. However, in some situations it is nice to be able to override that behavior (e.g. creating a [`<List>`\-like](#list) component).

maxColumnCount

`number`

No

Limits the number of columns used by [`usePositioner()`](#usepositioneroptions-deps). Useful for implementing responsive layouts.

#### Returns a [`Positioner`](#positioner)

[](#returns-a-positioner)

### Positioner

[](#positioner)

export interface Positioner {
  /\*\*
   \* The number of columns in the grid
   \*/
  columnCount: number;
  /\*\*
   \* The width of each column in the grid
   \*/
  columnWidth: number;
  /\*\*
   \* Sets the position for the cell at \`index\` based upon the cell's height
   \*/
  set: (index: number, height: number) \=> void;
  /\*\*
   \* Gets the \`PositionerItem\` for the cell at \`index\`
   \*/
  get: (index: number) \=> PositionerItem | undefined;
  /\*\*
   \* Updates cells based on their indexes and heights
   \* positioner.update(\[index, height, index, height, index, height...\])
   \*/
  update: (updates: number\[\]) \=> void;
  /\*\*
   \* Searches the interval tree for grid cells with a \`top\` value in
   \* betwen \`lo\` and \`hi\` and invokes the callback for each item that
   \* is discovered
   \*/
  range: (
    lo: number,
    hi: number,
    renderCallback: (index: number, left: number, top: number) \=> void
  ) \=> void;
  /\*\*
   \* Returns the number of grid cells in the cache
   \*/
  size: () \=> number;
  /\*\*
   \* Estimates the total height of the grid
   \*/
  estimateHeight: (itemCount: number, defaultItemHeight: number) \=> number;
  /\*\*
   \* Returns the height of the shortest column in the grid
   \*/
  shortestColumn: () \=> number;
  /\*\*
   \* Returns all \`PositionerItem\` items
   \*/
  all: () \=> PositionerItem\[\];
}

export interface PositionerItem {
  /\*\*
   \* This is how far from the top edge of the grid container in pixels the
   \* item is placed
   \*/
  top: number;
  /\*\*
   \* This is how far from the left edge of the grid container in pixels the
   \* item is placed
   \*/
  left: number;
  /\*\*
   \* This is the height of the grid cell
   \*/
  height: number;
  /\*\*
   \* This is the column number containing the grid cell
   \*/
  column: number;
}

* * *

### useScroller(offset?, fps?)

[](#usescrolleroffset-fps)

A hook for tracking whether the `window` is currently being scrolled and it's scroll position on the y-axis. These values are used for determining which grid cells to render and when to add styles to the masonry container that maximize scroll performance.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)

import \* as React from "react";
import { useMasonry, usePositioner, useScroller } from "masonic";

const MyMasonry \= (props) \=> {
  const containerRef \= React.useRef(null);
  const { offset, width } \= useContainerPosition(containerRef);
  const positioner \= usePositioner({ width });
  const { scrollTop, isScrolling } \= useScroller(offset);

  return useMasonry({
    ...props,
    containerRef,
    positioner,
    scrollTop,
    isScrolling,
  });
};

#### Arguments

[](#arguments-2)

Argument

Type

Description

offset

`number`

The vertical space in pixels between the top of the grid container and the top of the browser `document.documentElement`.

fps

`number`

This determines how often (in frames per second) to update the scroll position of the browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells. The default value of `12` has been very reasonable in my own testing, but if you have particularly heavy `render` components it may be prudent to reduce this number.

#### Returns `{scrollTop: number; isScrolling: boolean}`

[](#returns-scrolltop-number-isscrolling-boolean)

* * *

### useContainerPosition(elementRef, deps?)

[](#usecontainerpositionelementref-deps)

A hook for measuring the width of the grid container, as well as its distance from the top of the document. These values are necessary to correctly calculate the number/width of columns to render, as well as the number of rows to render.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/usemasonry-example-3pcg9?file=/src/index.js)

import \* as React from "react";
import { useWindowSize } from "@react-hook/window-size";
import { useContainerPosition, MasonryScroller } from "masonic";

const MyMasonry \= (props) \=> {
  const containerRef \= React.useRef(null);
  const \[windowWidth, windowHeight\] \= useWindowSize();
  const { offset, width } \= useContainerRect(
    containerRef,
    // In this example, we want to recalculate the \`offset\` and \`width\`
    // any time the size of the window changes
    \[windowWidth, windowHeight\]
  );

  return (
    <MasonryScroller
      width\={width}
      height\={windowHeight}
      containerRef\={containerRef}
      {...props}
    />
  );
};

#### Arguments

[](#arguments-3)

Argument

Type

Description

elementRef

`number`

A `ref` object created by `React.useRef()`. That ref should be provided to the `containerRef` property in [`useMasonry()`](#usemasonryoptions).

deps

`React.DependenciesList`

You can force this hook to recalculate the `offset` and `width` whenever this dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`, which would force the hook to recalculate any time the size of the browser `window` changed.

#### Returns [`ContainerPosition`](#containerposition)

[](#returns-containerposition)

### ContainerPosition

[](#containerposition)

export interface ContainerPosition {
  /\*\*
   \* The distance in pixels between the top of the element in \`elementRef\` and the top of
   \* the \`document.documentElement\`.
   \*/
  offset: number;
  /\*\*
   \* The \`offsetWidth\` of the element in \`elementRef\`.
   \*/
  width: number;
}

* * *

### useScrollToIndex(positioner, options?)

[](#usescrolltoindexpositioner-options)

A hook that creates a callback for scrolling to a specific index in the "items" array.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/usescrolltoindex-example-k5leo?file=/src/index.js)

import \* as React from "react";
import {
  useMasonry,
  usePositioner,
  useContainerPosition,
  useScroller,
  useScrollToIndex,
} from "masonic";

const MyMasonry \= (props) \=> {
  const containerRef \= React.useRef(null);
  const { offset, width } \= useContainerPosition(containerRef);
  const { scrollTop, isScrolling } \= useScroller(offset);
  const positioner \= usePositioner({ width });
  const scrollToIndex \= useScrollToIndex(positioner);

  React.useEffect(() \=> {
    if (props.scrollToIndex) {
      scrollToIndex(props.scrollToIndex);
    }
  }, \[props.scrollToIndex, scrollToIndex\]);

  return useMasonry({
    ...props,
    containerRef,
    positioner,
    scrollTop,
    isScrolling,
  });
};

#### Arguments

[](#arguments-4)

Argument

Type

Description

positioner

[`Positioner`](#positioner)

A positioner created by the [`usePositioner()`](#usepositioner) hook.

options

[`UseScrollToIndexOptions`](#usescrolltoindexoptions)

Configuration options. See [`UseScrollToIndexOptions`](#usescrolltoindexoptions).

#### `UseScrollToIndexOptions`

[](#usescrolltoindexoptions)

Option

Type

Description

element

`Window` | `HTMLElement` | `React.RefObject<HTMLElement>` | `null`

The window element or a React ref for the window element. That is, this is the grid container.

align

`"top"` | `"center"` | `"bottom"`

Sets the vertical alignment of the cell within the grid container.

height

`number`

The height of the grid.

offset

`number`

The vertical space in pixels between the top of the grid container and the top of the window.

#### Returns `(index: number) => void`

[](#returns-index-number--void)

* * *

### useResizeObserver(positioner)

[](#useresizeobserverpositioner)

This hook creates a resize observer that forces updates to the grid cell positions when mutations are made to cells affecting their height.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/useresizeobserver-example-w7r9i?file=/src/index.js)

import \* as React from "react";
import { useMasonry, usePositioner, useResizeObserver } from "masonic";

const MyMasonry \= (props) \=> {
  const positioner \= usePositioner({ width: 1024 });
  const resizeObserver \= useResizeObserver(positioner);

  return useMasonry({
    positioner,
    resizeObserver,
    scrollTop,
    isScrolling,
    height,
    ...props,
  });
};

#### Arguments

[](#arguments-5)

Argument

Type

Description

positioner

[`Positioner`](#positioner)

The cell positioner created by the [`usePositioner()`](#usepositioneroptions-deps) hook.

#### Returns a [`ResizeObserver`](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver)

[](#returns-a-resizeobserver)

* * *

### useInfiniteLoader(loadMoreItems, options?)

[](#useinfiniteloaderloadmoreitems-options)

A utility hook for seamlessly adding infinite scroll behavior to the [`useMasonry()`](#usemasonryoptions) hook and the components that use it. This hook invokes a callback each time the last rendered index surpasses the total number of items in your items array or the number defined in the `totalItems` option.

[Check out an example on **CodeSandbox**](https://codesandbox.io/s/useinfiniteloader-example-vn30p?file=/src/index.js)

import \* as React from "react";
import { Masonry, useInfiniteLoader } from "masonic";

const InfiniteMasonry \= (props) \=> {
  const \[items, setItems\] \= useState(\[
    /\* initial items \*/
  \]);
  const fetchMoreItems \= async (startIndex, stopIndex, currentItems) \=> {
    const nextItems \= await fetch(
      \`/api/get-more?after=${startIndex}&limit=${startIndex + stopIndex}\`
    );

    setItems((current) \=> \[...current, ...nextItems\]);
  };
  const maybeLoadMore \= useInfiniteLoader(fetchMoreItems, {
    isItemLoaded: (index, items) \=> !!items\[index\],
  });

  return <Masonry {...props} items\={items} onRender\={maybeLoadMore} />;
};

#### Arguments

[](#arguments-6)

Argument

Type

Description

loadMoreItems

`(startIndex: number, stopIndex: number, items: any[]) => any`

This callback is invoked when more rows must be loaded. It will be used to determine when to refresh the list with the newly-loaded data.

options

[`UseInfiniteLoaderOptions`](#useinfiniteloaderoptions)

Configuration object for your loader, see [`UseInfiniteLoaderOptions`](#useinfiniteloaderoptions) below.

#### UseInfiniteLoaderOptions

[](#useinfiniteloaderoptions)

Property

Type

Default

Description

isItemLoaded

`(index: number, items: any[]) => boolean`

`(index, items) => items[index] !== undefined`

A callback responsible for determining the loaded state of each item. Should return `true` if the item has already been loaded and `false` if not.

minimumBatchSize

`number`

`16`

The minimum number of new items to be loaded at a time. This property can be used to batch requests and reduce HTTP requests.

threshold

`number`

`16`

The threshold at which to pre-fetch data. A threshold X means that new data should start loading when a user scrolls within X cells of the end of your `items` array.

totalItems

`number`

`9E9`

The total number of items you'll need to eventually load (if known). This can be arbitrarily high if not known.

#### Returns `(startIndex: number, stopIndex: number, items: any[]) => any`

[](#returns-startindex-number-stopindex-number-items-any--any)

* * *

### createPositioner(columnCount, columnWidth, columnGutter, rowGutter)

[](#createpositionercolumncount-columnwidth-columngutter-rowgutter)

Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses this utility under the hood.

#### Arguments

[](#arguments-7)

Argument

Type

Description

columnCount

`number`

The number of columns in the grid

columnWidth

`number`

The width of each column in the grid

columnGutter

`number`

The amount of horizontal space between columns in pixels.

rowGutter

`number`

The amount of vertical space between cells within a column in pixels (falls back to `columnGutter`).

maxColumnCount

`number`

The upper bound of column count.

#### Returns [`Positioner`](#positioner)

[](#returns-positioner)

* * *

### createResizeObserver(positioner, updater)

[](#createresizeobserverpositioner-updater)

Creates a resize observer that forces updates to the grid cell positions when mutations are made to cells affecting their height.

#### Arguments

[](#arguments-8)

Argument

Type

Description

positioner

[`Positioner`](#positioner)

A cell positioner created by the [`usePositioner()`](#usepositioneroptions-deps) hook or the [`createPositioner()`](#createpositionercolumncount-columnwidth-columngutter-rowgutter) utility

updater

`(updates: number[]) => void`

A callback that fires whenever one or many cell heights change. Updates are provided to the callback in the form of a flat array: `[index, height, index, height, index, height, ...]`

#### Returns a [`ResizeObserver`](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver)

[](#returns-a-resizeobserver-1)

* * *

Differences from [react-virtualized](https://github.com/bvaughn/react-virtualized)
----------------------------------------------------------------------------------

[](#differences-from-react-virtualized)

There are actually quite a few differences between these components and the originals, despite the overall design being highly inspired by them.

1.  The `react-virtualized` component requires a `<CellMeasurer>`, `cellPositioner`, and `cellMeasurerCache` and a ton of custom implementation to get off the ground. It's very difficult to work with. In `Masonic` this functionality is built in using [`resize-observer-polyfill`](https://github.com/que-etc/resize-observer-polyfill) for tracking cell size changes.
    
2.  This component can auto-calculate the number of columns to render based upon the defined `columnWidth` property. The column count will update any time it changes.
    
3.  The algoirthm for updating cell positions and sizes is much more efficient in this component because only specific cells and columns are updated when cell sizes change, whereas in the original a complete reflow has to triggered.
    
4.  The API and internals are a complete rewrite and because of the above points, is much easier to use in my opinion.
    

* * *

Legacy Documentation
--------------------

[](#legacy-documentation)

*   [Version 2 documentation](/jaredLunde/masonic/blob/main/docs/v2.md)

LICENSE
-------

[](#license)

MIT

About
-----

🧱 High-performance masonry layouts for React

[codesandbox.io/s/0oyxozv75v](https://codesandbox.io/s/0oyxozv75v "https://codesandbox.io/s/0oyxozv75v")

### Topics

[react](/topics/react "Topic: react") [hooks](/topics/hooks "Topic: hooks") [list](/topics/list "Topic: list") [infinite-scroll](/topics/infinite-scroll "Topic: infinite-scroll") [virtualization](/topics/virtualization "Topic: virtualization") [masonry](/topics/masonry "Topic: masonry") [window](/topics/window "Topic: window") [masonry-layout](/topics/masonry-layout "Topic: masonry-layout") [masonry-grid](/topics/masonry-grid "Topic: masonry-grid") [virtualized](/topics/virtualized "Topic: virtualized") [react-masonry-component](/topics/react-masonry-component "Topic: react-masonry-component") [react-hooks](/topics/react-hooks "Topic: react-hooks") [react-masonry](/topics/react-masonry "Topic: react-masonry") [masonry-component](/topics/masonry-component "Topic: masonry-component") [virtualized-scroll](/topics/virtualized-scroll "Topic: virtualized-scroll") [react-masonry-grid](/topics/react-masonry-grid "Topic: react-masonry-grid") [virtualized-masonry](/topics/virtualized-masonry "Topic: virtualized-masonry")

### Resources

[Readme](#readme-ov-file)

### License

[MIT license](#MIT-1-ov-file)

### Code of conduct

[Code of conduct](#coc-ov-file)

### Uh oh!

There was an error while loading. Please reload this page.

[Activity](/jaredLunde/masonic/activity)

### Stars

[**1.2k** stars](/jaredLunde/masonic/stargazers)

### Watchers

[**7** watching](/jaredLunde/masonic/watchers)

### Forks

[**55** forks](/jaredLunde/masonic/forks)

[Report repository](/contact/report-content?content_url=https%3A%2F%2Fgithub.com%2FjaredLunde%2Fmasonic&report=jaredLunde+%28user%29)

[Releases 9](/jaredLunde/masonic/releases)
------------------------------------------

[

v4.1.0 Latest

Apr 22, 2025



](/jaredLunde/masonic/releases/tag/v4.1.0)

[\+ 8 releases](/jaredLunde/masonic/releases)

[Used by 873](/jaredLunde/masonic/network/dependents)
-----------------------------------------------------

[

*   ![@fountain-ink](https://avatars.githubusercontent.com/u/172635984?s=64&v=4)
*   ![@fathinmuhammad](https://avatars.githubusercontent.com/u/51737398?s=64&v=4)
*   ![@Abdojudo55](https://avatars.githubusercontent.com/u/168235557?s=64&v=4)
*   ![@alw-personal](https://avatars.githubusercontent.com/u/102007240?s=64&v=4)
*   ![@Legaz-le](https://avatars.githubusercontent.com/u/188694281?s=64&v=4)
*   ![@andreisucman](https://avatars.githubusercontent.com/u/67225216?s=64&v=4)
*   ![@UncleDave](https://avatars.githubusercontent.com/u/3244206?s=64&v=4)
*   ![@Afilmory](https://avatars.githubusercontent.com/u/214944158?s=64&v=4)

\+ 865](/jaredLunde/masonic/network/dependents)

[Contributors 12](/jaredLunde/masonic/graphs/contributors)
----------------------------------------------------------

*   [![@jaredLunde](https://avatars.githubusercontent.com/u/86995?s=64&v=4)](https://github.com/jaredLunde)
*   [![@semantic-release-bot](https://avatars.githubusercontent.com/u/32174276?s=64&v=4)](https://github.com/semantic-release-bot)
*   [![@tobz1000](https://avatars.githubusercontent.com/u/1471978?s=64&v=4)](https://github.com/tobz1000)
*   [![@jonbri](https://avatars.githubusercontent.com/u/1750227?s=64&v=4)](https://github.com/jonbri)
*   [![@khmm12](https://avatars.githubusercontent.com/u/4437249?s=64&v=4)](https://github.com/khmm12)
*   [![@V3RON](https://avatars.githubusercontent.com/u/8137511?s=64&v=4)](https://github.com/V3RON)
*   [![@bnjmnt4n](https://avatars.githubusercontent.com/u/813865?s=64&v=4)](https://github.com/bnjmnt4n)
*   [![@cookpete](https://avatars.githubusercontent.com/u/1926029?s=64&v=4)](https://github.com/cookpete)
*   [![@johnsonsu](https://avatars.githubusercontent.com/u/4886073?s=64&v=4)](https://github.com/johnsonsu)
*   [![@wjdwndud0114](https://avatars.githubusercontent.com/u/30526747?s=64&v=4)](https://github.com/wjdwndud0114)
*   [![@Dimitri-WEI-Lingfeng](https://avatars.githubusercontent.com/u/42238241?s=64&v=4)](https://github.com/Dimitri-WEI-Lingfeng)

Languages
---------

*   [TypeScript 98.8%](/jaredLunde/masonic/search?l=typescript)
*   [JavaScript 1.1%](/jaredLunde/masonic/search?l=javascript)
*   [Shell 0.1%](/jaredLunde/masonic/search?l=shell)

Footer
------

[](https://github.com)© 2025 GitHub, Inc.

### Footer navigation

*   [Terms](https://docs.github.com/site-policy/github-terms/github-terms-of-service)
*   [Privacy](https://docs.github.com/site-policy/privacy-policies/github-privacy-statement)
*   [Security](https://github.com/security)
*   [Status](https://www.githubstatus.com/)
*   [Docs](https://docs.github.com/)
*   [Contact](https://support.github.com?tags=dotcom-footer)
*   Manage cookies
*   Do not share my personal information

You can’t perform that action at this time.

Demander

Expliquez ceciContinuer à écrireInvite personnaliséeTraduireRésumerAméliorer l'écritureCorriger l'orthographe et la grammaireRépondre à cette questionExpliquez les codesTrouver des éléments d'actionRendre plus courtRendre plus longSimplifier la langueChanger le ton - ProfessionnelChanger le ton - DécontractéChanger de ton - DirectChanger de ton - ConfiantChanger de ton - AmicalBrainstorm sur...Aperçu...Article de blog...Paragraphe sur...Post sur les médias sociaux...Communiqué de presseHistoire créativeListe de choses à faire...Ordre du jour de la réunion...Email de vente...Plus persuasifAjouter des détailsAjouter des statistiquesAjouter de l'humourPlus d'excusesPlus engageant

አማርኛالعربيةБългарскиবাংলাCatalàČeštinaDanskDeutschΕλληνικάEnglishEspañolEestiفارسیSuomiFilipinoFrançaisગુજરાતીעבריתहिन्दीHrvatskiMagyarBahasa IndonesiaItaliano日本語ಕನ್ನಡ한국어LietuviųLatviešuമലയാളംमराठीBahasa MelayuNederlandsNorskPolskiPortuguêsRomânăРусскийSlovenčinaSlovenščinaСрпскиSvenskaKiswahiliதமிழ்తెలుగుไทยTürkçeУкраїнськаاردوTiếng Việt简体中文繁體中文

*   GPT-4o Mini
    
    Très rapide, idéal pour la plupart des tâches quotidiennes.
    
    Coût 1 requête rapide.
    
*   GPT-4o
    
    Le modèle phare le plus récent et le plus avancé d'OpenAI qui peut raisonner en temps réel à travers l'audio, la vision et le texte.
    
    Coûte 1 requête avancée.
    
*   o1
    
    Le modèle avancé de raisonnement d'OpenAI pour les tâches complexes en science, mathématiques et programmation. Prend plus de temps pour réfléchir, offrant des réponses bien réfléchies aux problèmes difficiles.
    
    Coût 15 Requête avancée
    
*   o1 Mini
    
    Le modèle de raisonnement de base d'OpenAI pour le raisonnement en STEM, en particulier en mathématiques et en codage. Idéal pour les tâches nécessitant une logique solide sans connaissances étendues.
    
    Coût 5 Requête avancée
    
*   o3 Mini
    
    Le modèle de raisonnement de base d'OpenAI pour le raisonnement en STEM, en particulier en mathématiques et en codage. Idéal pour les tâches nécessitant une logique solide sans connaissances étendues.
    
    Coût 5 Requête avancée
    
*   Claude 3.5 Haiku
    
    Le modèle le plus compact d'Anthropic, conçu pour une réactivité quasi instantanée et des expériences IA fluides qui imitent les interactions humaines.
    
    Coût 1 requête rapide.
    
*   Claude 3.5 Sonnet
    
    Très rapide, idéal pour la plupart des tâches quotidiennes.
    
    Coûte 1 requête avancée.
    
*   Claude 3.5 Opus
    
    Le modèle le plus puissant d'Anthropic, offrant des performances de pointe sur des tâches extrêmement complexes et démontrant une aisance et une compréhension semblables à celles d'un humain.
    
    Coût de 2 requêtes avancées.
    
*   Gemini 1.5 Pro
    
    Le modèle léger de Google, optimisé pour la vitesse et l'efficacité.
    
    Coûte 1 requête avancée.
    
*   Gemini 2.0 Flash
    
    Modèle le plus équilibré de Google, alliant parfaitement capacité et efficacité.
    
    Coût 1 requête rapide.
    
*   Llama 3.3 70B
    
    Le modèle polyvalent de Meta, excellent dans la synthèse de textes longs, les conversations multilingues et l'assistance au codage.
    
    Coût 1 requête rapide.
    
*   Llama 3.1 405B
    
    Le modèle open-source le plus puissant de Meta, rivalisant avec les meilleurs assistants IA en termes de connaissances générales, de mathématiques et de capacités multilingues.
    
    Coûte 1 requête avancée.
    
*   DeepSeek R1
    
    Le modèle phare de raisonnement de DeepSeek, spécialisé dans les mathématiques, la programmation et les tâches de raisonnement en plusieurs étapes, égale ou dépasse OpenAI o1 dans de nombreux benchmarks.
    
    Coût 2 Requête avancée
    

Soumettre (enter)

Faire une critique & gagner du crédit ❤

Chat

Demander

Recherche

Écrire

Image

Fichier de discussion

Vision

Page Entière

Invitez &Gagnez

Se connecter en tant qu'utilisateur

Retour d'information

### Invitez des amis et gagnez des crédits

Close modal

Gagnez 0 Fast credits & 1 crédit Avancé1 pour vous et votre ami.Gagnez plus lorsque vous parrainez davantage!

Invitez votre ami avec un lien d'invitation

Vos amis s'inscrivent

Ils installent l'extension et se connectent. Vous gagnez tous les deux des crédits!

Copier le lien d'invitation

Vérifier les registres d'invitation

*   « Résumer la page »
    

ChatGPT Sidebar

Demander à ChatGPT